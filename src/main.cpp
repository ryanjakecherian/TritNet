#include "TritNet.hpp"

#include <cuda_runtime.h>
#include <iostream> //for debug

int main() {

 //========= GPU SELECT ==================
    int deviceCount;
    cudaGetDeviceCount(&deviceCount);
    if (deviceCount > 0) {
        cudaSetDevice(0);  // Select the first GPU (index 0)
    }
 //=======================================


 //========== MAIN PROGRAM ===============

    //params
    int input_dim = 32;                  //                              NOTE: MUST BE MULTIPLE OF THE WORD_SIZE (zero-padding functionality not implemented yet)
    int output_dim = 32;                 //                              NOTE: MUST BE MULTIPLE OF THE WORD_SIZE (zero-padding functionality not implemented yet)
    int depth = 6;                      //number of hidden layers.
    int hidden_layers[depth]={64, 64, 64, 64, 64, 64};        //dimensions of hidden layers.  NOTE: MUST BE MULTIPLES OF THE WORD_SIZE (zero-padding functionality not implemented yet)
                                        //1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024

    int batch_size = 4;                 //number of samples per batch.


    // Set-up network
    TritNet network = TritNet<uint32_t>(input_dim, output_dim, depth, hidden_layers);


    // #########################################################################################
    // // ## Random initialisation

    //     //weights init
    //         network.random_init();
    //     //

    //     //input init
    //         uint32_t* input_batch = new uint32_t[batch_size*input_dim/WORD_SIZE];
    //         std::cout<<"Initialising input activations batch to random values..."<<std::endl;
    //         randomise<uint32_t>(input_batch, batch_size*input_dim/WORD_SIZE);
    //         print<uint32_t>(input_batch, batch_size, input_dim/WORD_SIZE);
    //         std::cout<<std::endl<<std::endl<<"_____________________"<<std::endl;
    //     //

    // ## Manual initialisation - useful for debug. with python 
         // IMPORTANT: WHILST I HAVE IMPLEMENTED SIZE CHECKING FOR ARRAY_INIT(), THERE IS NO DIMENSION (ROWS, COLS) CHECKER, AS THE INPUT IS A FLAT LIST.
         //
         //weights init

            uint32_t python_weights[1536] = {33851259, 617197571, 965214210, 1092757575, 1169907777, 470881021, 12861443, 2460249421, 151009982, 3031927313, 1103302562, 1752895556, 3759693345, 843588290, 420043940, 867699107, 2132640, 341976092, 357565078, 3070265136, 2542856585, 1348001952, 1765813248, 243269925, 1485234962, 12003708, 4099616549, 122726036, 2972865203, 19597969, 3762429696, 103221792, 2167181385, 1273266319, 887296001, 1888814824, 1728054912, 2186561798, 411075400, 606775379, 25362689, 4102300335, 421549337, 201999777, 1653214832, 154157584, 1393431761, 2168455698, 67518785, 101746822, 256906584, 3071870057, 673797121, 2260098678, 1161884676, 69473280, 738480404, 894439431, 2158168869, 18270221, 2822838785, 577554700, 1095766333, 1241552918, 1752246404, 403964468, 3288574497, 584176032, 973114266, 3823690754, 220277464, 625115266, 1380467713, 1224761646, 638869580, 59000721, 385917202, 2310389776, 1089610521, 3426792528, 3766886417, 3783266754, 136712456, 2564238, 678105650, 788799235, 104694541, 2975731778, 624493805, 3007316610, 142888968, 2829205856, 71411968, 268440588, 61448413, 2826981767, 1087448996, 2417104928, 3389555132, 140701718, 407648571, 956539920, 2709343285, 2433029768, 2557245638, 35820608, 2724104838, 3802136588, 319885, 2420251822, 2692745228, 1446649192, 141112320, 3624867393, 1621181088, 1210354448, 335710726, 2030117129, 3087335504, 177834826, 1348635851, 2181955792, 71328778, 1046553858, 1092796596, 478294161, 579413056, 2778473633, 564922796, 1381312040, 1090523633, 1645123160, 1570051077, 2719557644, 3519251487, 890381570, 2753956384, 168069408, 2350519312, 2401435786, 1168166081, 52580464, 51930401, 3254861980, 320391284, 2157974784, 3242852356, 53504024, 2166729737, 1296541825, 1629678752, 2710689062, 3498726610, 1103413936, 8791048, 3259196046, 1162521416, 50462981, 54542899, 691175545, 569955075, 1771980578, 4209844, 1162346817, 169279621, 822839544, 3258198272, 1211251394, 4162969978, 705086097, 6447295, 2186363974, 139465280, 19174416, 1676198294, 2262586401, 179307868, 629840930, 12439720, 1418217498, 2472665833, 2248705568, 1124697401, 169903111, 75555841, 2553675904, 4181785440, 44354954, 1412448424, 2165646472, 11539307, 940654682, 144201308, 1083383297, 3800238925, 1075060758, 2151211904, 2199650502, 1083900424, 3268412184, 889984049, 609320212, 604025444, 2441151256, 201403202, 608707781, 134483991, 653288161, 840650959, 3425796271, 875041114, 2315853867, 348438956, 2990618452, 443698500, 540776, 2762097600, 50595459, 19398736, 2968030354, 8536137, 2273657378, 2308187188, 4341850, 2281713664, 143364189, 1409516042, 1896277585, 70399684, 2155897347, 1792673640, 3313600520, 109353161, 1225039960, 731482124, 1637876256, 1192862634, 37923917, 3009696316, 3495051562, 1504727425, 424925278, 537427971, 1113737862, 2849059570, 1452802626, 822083636, 2298486915, 2237097, 2206516273, 3674212038, 2688649684, 1108483087, 19867744, 29887136, 3221348623, 1313018962, 2685014230, 2457494024, 2563778720, 2149752874, 337954529, 238289440, 3393819152, 1094725975, 1104871442, 25165892, 813741616, 2588090936, 680037389, 3907224284, 700232227, 610611713, 860760113, 640765858, 1409684134, 1954676980, 850937384, 39653459, 1248725585, 239116324, 2886213888, 3089154819, 680562993, 537202694, 952188666, 882973068, 344480132, 3389072444, 268537876, 311443723, 2453118978, 2166363754, 2225086978, 541234266, 898154537, 76813445, 3297326376, 3239648064, 1342704265, 1940269109, 1585514823, 2483106336, 536937036, 3020122242, 268779792, 2365597780, 189212192, 1284772118, 280121542, 343155334, 3222143760, 3497464592, 616599635, 33817631, 807023172, 2211257683, 369656338, 789243008, 3345880704, 3022168194, 2255257738, 354178098, 3146401128, 1111885857, 748837640, 2269151572, 892034053, 170085006, 3400008226, 2604205456, 1283325956, 1942634521, 1107593736, 2149803712, 2147585310, 1078200832, 12608784, 167838208, 825362452, 1745955907, 227819682, 2223837841, 246554897, 324873274, 270112788, 4271178121, 185926188, 3729523092, 134354944, 1914950464, 1971325829, 1635534786, 643056642, 2858186161, 76616104, 1615347768, 1796872220, 2149928966, 839795264, 1095968002, 2724217252, 3288728274, 2416204106, 270798868, 1745437312, 135407043, 629454356, 2785545834, 3861118977, 2421385328, 2365952352, 1141280001, 2288106777, 3426418370, 1376575348, 3380889922, 275317254, 7061513, 61734955, 690815616, 3020967948, 2382570829, 831259856, 3120606224, 191432271, 699473965, 2165876750, 3491004740, 2693959705, 107492242, 1199932434, 1145372940, 1950550030, 2707598340, 222888027, 2954514482, 645988442, 3238003784, 2756263998, 2978777616, 998644833, 281117364, 474244048, 3230468929, 2820670492, 329363468, 2439102640, 173149080, 469827841, 17785490, 198675, 2700346758, 2156005382, 184387, 3481464105, 386272320, 845874371, 431068038, 3574420064, 2147751320, 2216952090, 2515592, 12745763, 1082488208, 2686452100, 31459586, 316047376, 435258129, 172693504, 743473441, 8522266, 1269492040, 177209660, 1363732481, 339214608, 68689891, 1620709892, 1951867160, 289720825, 1121849496, 2445290120, 2215906860, 1150485810, 1616837677, 4045173265, 4028963944, 297217128, 1627471912, 1350635544, 3025847372, 2151828640, 420209506, 1463895078, 347210580, 3762299649, 2301806592, 3763437984, 2655405828, 21189058, 2032462354, 553877509, 538396525, 4055899163, 438049376, 1108361938, 2987727117, 229658, 3430482577, 609973132, 2153939968, 588480, 155593812, 1291855151, 584060936, 2151716868, 2432861440, 1438664983, 573538545, 71106901, 1126304000, 70393986, 1476425856, 410014214, 8536201, 2151681025, 553920682, 655917731, 2147516992, 298846224, 1208586465, 2168946712, 541331948, 362987651, 2392113420, 377506084, 1240105412, 170646034, 139517813, 3355631882, 494648, 38947109, 689079044, 1652875968, 2216337772, 1751384224, 1095832502, 1110024290, 3187870036, 134959201, 306710546, 3758801920, 1162957697, 3230945328, 2152356944, 1486962737, 212540424, 1415653184, 1611825192, 3672813, 538595058, 51921808, 1477447851, 3255066368, 1218453961, 3244337316, 1011069873, 453295297, 1212232103, 3227623832, 3858902026, 3283289091, 410161288, 1158101953, 3289531201, 672407301, 3047232546, 39208118, 3258974216, 1177609416, 403435632, 1717629281, 3732996516, 272109716, 3901252022, 135549740, 3830211657, 550503569, 978905702, 1243239552, 1372593266, 2133360896, 642779169, 1536135721, 3960849624, 3758098658, 2181060840, 4113597607, 1093084684, 2417259712, 341115394, 2234138755, 44109904, 1111519330, 4188135436, 222390528, 2149635207, 3937010690, 2550260324, 1681327383, 191078672, 2969842308, 2191590336, 104926220, 85467399, 2215137536, 504544853, 2349999072, 178531219, 1459925764, 74711060, 136624328, 3758623913, 196269212, 80483016, 229127254, 28344488, 1379404349, 113443237, 3367527210, 394297490, 67502692, 3300926475, 2714606637, 94905024, 2577669728, 562319686, 1350565905, 152317996, 2411856915, 347718442, 2428405904, 2368364645, 1537803690, 115149456, 2181804648, 1305497346, 37780610, 2819647078, 2747566121, 2259583563, 25535545, 4278760196, 698213292, 404296709, 2162632712, 1886206080, 3324985800, 845546510, 505960033, 270632466, 3393519704, 1361258034, 3376808657, 604322816, 3024355329, 371859592, 907872900, 3057147907, 95167170, 1187013656, 359273481, 1885344915, 2181686798, 2685182985, 3166700697, 30433411, 25168776, 2771796076, 284232187, 616178977, 1610678419, 1653744132, 1387004470, 3323208242, 438845617, 1146139286, 2182235654, 2307281984, 1149255942, 3511157030, 2205681754, 1372587520, 1396591241, 875270458, 3876066848, 101001936, 3965124708, 2751465862, 2471637012, 243761228, 3576263693, 3029385472, 860500250, 487673472, 2468348010, 203467011, 2519453905, 462690605, 1647945028, 2249005345, 3590324760, 2248680457, 1074917394, 357061136, 2568136457, 270156035, 1141182468, 561255814, 718806794, 2211578061, 2148906242, 427375120, 3837821968, 3724661460, 2188888, 1241981088, 1105928, 84878471, 3679027204, 2733867142, 134223148, 1631987712, 2257211751, 1714426475, 2516201748, 2198639700, 378169477, 1143247974, 339740698, 28445714, 1749101586, 1606170, 176554244, 909120065, 1074800964, 1141084192, 474757124, 3305671872, 23148680, 335578113, 4182836800, 117506101, 1278279691, 607387784, 2416666500, 2225111360, 2303106240, 227246093, 10485763, 2187348074, 1885479948, 3107416449, 301114824, 3725526020, 2250252416, 87294344, 675346752, 17309508, 3376545796, 134909977, 2218793040, 285332810, 2059745027, 21272989, 1360135202, 1749586449, 2282377440, 2617425929, 1677927024, 198155264, 2295349441, 111182229, 1099522643, 2319582564, 2864848399, 2688574979, 122140162, 4052365588, 713608514, 1140898787, 2228232, 302125218, 11340572, 2518690832, 505636946, 624150112, 227038755, 37782032, 571475412, 1201393857, 1107499051, 3087684993, 2978120608, 2101297, 1147683019, 3490842824, 843358213, 3645217344, 2626077444, 472419384, 557950145, 419677445, 3296987918, 2452242464, 363632785, 1981391798, 2740852400, 2597505, 679904896, 707768491, 2688659542, 168051201, 16204108, 1220183050, 287350171, 1239392297, 1143227019, 3228577184, 684854034, 153753121, 137448677, 2194059647, 210022789, 809845820, 1226050312, 606757952, 201740467, 1885487242, 149608774, 1091750166, 353108425, 2821885219, 570511536, 2692776492, 421572377, 2290729496, 2149965828, 738498338, 1363148876, 75891043, 2314251, 26747136, 3332018434, 818433039, 1032593143, 2699084072, 3171208, 5488, 350593553, 2460079564, 539078272, 2441759764, 1208043210, 819159296, 6558506, 55263616, 689463392, 571302180, 121131565, 2346740032, 1617534042, 3229647252, 2949120011, 2308203458, 2701231731, 677663527, 1889322528, 1231190148, 69648560, 2554082120, 4772996, 2449592836, 1648662600, 1934451859, 372244999, 3226490418, 1159627936, 107028, 93883089, 1107857978, 168384547, 27308729, 139723627, 4072696434, 1394149028, 1879089305, 875111737, 14770914, 1124090373, 2866684453, 2217394348, 377513570, 673266184, 9782662, 1650754830, 1676487586, 61081995, 3020964335, 388338746, 2824760426, 137790728, 822935689, 1428275456, 339609724, 1074284717, 102780579, 3580952761, 2214216732, 1792583825, 88984328, 2902511778, 21020810, 2161148073, 314849675, 304259520, 2217346442, 3437510666, 2953054256, 2979045456, 1188309026, 240393299, 3990325252, 2585209648, 69841426, 2147555272, 1108359437, 2379284680, 570720392, 146932377, 3760201032, 1074495813, 1137022730, 3113394194, 93540649, 126883012, 2919417896, 688164914, 3804431874, 2527215908, 134759704, 1707643146, 1703411717, 1450574080, 88148048, 144854092, 855639756, 1008051888, 568328599, 622954652, 3632332949, 151208290, 1616002598, 338704995, 2351080530, 1519601926, 276177683, 1731205481, 975184231, 843255809, 1107651661, 3045935142, 1112820072, 155190289, 2723692888, 2450686340, 2531649, 305873066, 672735232, 3378511896, 573244169, 1578747156, 3352494082, 330056239, 1342374295, 7537184, 2299399344, 322175350, 25477688, 13799436, 1971337280, 671613184, 10510515, 2013489444, 562400524, 2148289316, 88287805, 3251347657, 3288403745, 203778646, 1074397618, 3389278564, 4497747, 125364234, 221077203, 21300237, 325782852, 7349857, 2246070032, 67355301, 1158684710, 2823980048, 3826018349, 67366918, 3830712440, 2874171400, 1443372, 2170863653, 574898693, 273037313, 549457040, 3696616458, 2451780465, 2906798184, 213008459, 572853009, 3208022348, 23363621, 2471578385, 8720386, 2867863808, 2276647684, 272768, 2256933848, 1689725281, 2284094512, 101204032, 2529241408, 2692759128, 2298616960, 542573062, 1344569620, 402796598, 4026769025, 3885569, 3903128688, 3267637666, 205717575, 19259424, 1384161282, 304262074, 2434986496, 2693900104, 1073822696, 1781815494, 2121141281, 3504407736, 713393154, 579093678, 3792097324, 520338080, 2852201084, 3037078166, 473464000, 72204416, 1646406695, 3698556455, 1644263490, 58966663, 934283394, 2619342993, 1080827364, 1917321734, 2154670082, 1353261125, 1452802501, 84998288, 554963483, 3560976897, 168247301, 405858490, 2843773090, 2419639084, 22651683, 2292924705, 1107951878, 1107847680, 1355560513, 91290114, 2484376589, 75792409, 583270812, 1666800257, 537170161, 1762246816, 2294579844, 2148406920, 1208223424, 2173178754, 173155600, 3165262981, 3594401958, 1358994561, 1829259273, 1448156710, 633353732, 2216723906, 311924933, 210002066, 2688948840, 2898084, 675519936, 228076552, 1678559516, 349217345, 1216395400, 943198595, 3407890560, 7455017, 2511511639, 2785903940, 68977297, 3329364144, 1079017675, 3356771392, 100949764, 3444940, 295342464, 148996096, 826443274, 1033898020, 268894368, 4030898212, 1085960624, 1619267593, 1443760154, 1477677134, 2871274762, 46172801, 92962, 413143504, 1397229449, 61555846, 346758704, 2451685458, 1149974490, 2434864626, 1166017838, 1511670534, 562561861, 1841315978, 1108951299, 2202642304, 2445980808, 13132435, 1744851544, 1219235884, 2753089208, 285231658, 2013862930, 3513849385, 1074850853, 302567436, 1201283983, 1627755055, 19665551, 220905510, 1342243422, 3332930769, 56110787, 642568072, 258752782, 1975816568, 105531403, 87672345, 3800612632, 3662809690, 2351842728, 1301808197, 1850804612, 151142566, 277496849, 2500011273, 2165391884, 152877827, 1409423672, 158567249, 425263232, 2700345691, 90070146, 4247905, 3796173369, 304933160, 890308811, 604898572, 3450545418, 2248736768, 2153793296, 1814099221, 714138138, 2441619586, 2202047496, 725653048, 1347685436, 2168492585, 3463058210, 2177683986, 474087955, 3290512277, 29516457, 3372343297, 69670185, 289441809, 1134742612, 3490194155, 415838484, 2080481538, 1411991171, 2731598021, 4066512, 3631717708, 230818307, 82715648, 614232373, 2166259840, 772264132, 438323842, 4062225593, 21274720, 620925183, 579865383, 1009804867, 1703569512, 571238696, 1731680, 2818574768, 666586501, 2225081324, 3994259972, 1275102240, 3771219968, 2152073360, 2161121369, 3427000500, 67193126, 1107493651, 547162183, 868679682, 134356516, 599825672, 2258153490, 2844004920, 1466417771, 2704020560, 1432430615, 277057044, 11147286, 549855298, 744751104, 404759569, 271222801, 578175140, 252733498, 296948099, 1708340235, 2603759684, 17856008, 1384427819, 2283963504, 86188318, 286296096, 1814114833, 53552321, 4068607156, 612581396, 1074050672, 3561677460, 577306630, 80085211, 1223111329, 2718957647, 784626312, 3230762120, 544079955, 1300500514, 2300608684, 157999110, 1897681288, 621351864, 42078577, 1383618369, 109249078, 2702315651, 2969764909, 614765625, 3226838529, 3759156642, 880547853, 2181270881, 17713989, 2198679600, 1747624116, 2353008714, 824945172, 10791953, 1516371986, 2485166892, 2739619088, 79693985, 2216854809, 17010444, 1304723603, 2429828110, 2184372235, 4261440, 526101, 803223, 344399895, 2152514308, 1331572906, 625147987, 3357802768, 1257349330, 840190004, 1618382775, 2131953831, 30081738, 2416050245, 536969729, 1544831463, 1149659523, 729891586, 42208276, 286295257, 1478501761, 3239590016, 160563240, 2516879378, 340533100, 860391638, 3422684900, 739311616, 53793812, 3274981544, 31327897, 671223896, 471929602, 3934277891, 59261472, 3781932, 3088063140, 1482721930, 1883324203, 1369451817, 5013569, 224266822, 3457371907, 2452950784, 2353008720, 1091506304, 275058818, 1290899605, 750883716, 1342504960, 268472920, 807031824, 23077059, 2724808925, 53686774, 103375459, 956555686, 823662337, 560498184, 2241342508, 1159738680, 1076928428, 2250621064, 2553479750, 1610892200, 1448642945, 537931792, 406880399, 2283591296, 794845416, 1716789737, 2670777897, 665767, 2752432518, 2312181642, 2441711706, 544052097, 3427298824, 2550957012, 1619608754, 3299281072, 674841220, 927470223, 3221491264, 3297599839, 1049640, 2492256784, 224411976, 3275755371, 902302084, 169874441, 416913, 1243731968, 839945484, 222737808, 2433253415, 457703685, 462443692, 2455809949, 374619905, 1989484449, 2193794628, 284165188, 1768442894, 2760280222, 2838515848, 10815860, 249844624, 1375881730, 260178208, 220762176, 3414385040, 2106339866, 921796624, 940755085, 298131008, 1100655748, 3468972234, 3893957450, 2232188864, 1763268755, 211038796, 2587366146, 977828036, 1513627697, 2956613740, 604225776, 1284243540, 111570998, 3759253608, 3913525248, 2720550336, 1486947571, 268517973, 2888056896, 419695650, 2320763332, 3734159384, 1177334050, 23130897, 3644852238, 1623205904, 1343133830, 298402446, 1342980537, 1717792832, 543496410, 1170550162, 1009139224, 622993422, 1120405152, 2688093696, 1279525005, 180097024, 3558867436, 1182797581, 75972672, 1227107416, 252346893, 2176205841, 1088009984, 572949164, 1615099520, 2122588685, 3537937316, 2643460141, 2173891844, 1136923176, 168634992, 1714962744, 1107575808, 771928110, 1075840641, 281751584, 2420269173, 20077438, 1309164200, 3548414600, 1147888160, 393285, 2148729096, 1275611154, 147331726, 2504040732, 1141430456, 824726064, 1821392944, 1626880154, 2827968585, 1616128806, 539435160, 23334980, 80254280, 3913590828, 2015638028, 1820362290, 1443555867, 3494381654, 43720121, 2767884680, 1158225931, 4457987, 2832337045, 3599697098, 78943745, 305251469, 569378369, 68552048, 2886811206, 2299822852, 1434599681, 2852798477, 3252257121, 3365492673, 486875159, 528629884, 2207305794, 2755741952, 554688515, 287363072, 1784712482, 274338052, 283405568, 575254634, 2770600136, 3562099776, 203587903, 2840784, 151913497, 539977728, 976029832, 874195089, 1618133134, 17282179, 488709102, 270353873, 1007997188, 1275119504, 746586248, 3724616832, 2974030164, 69360935, 428871810, 1499561616, 1689009395, 17082280, 2182340657, 1212042816, 3125936646, 2157117445, 2470523086, 2399257121, 1443893302, 2670395481, 343940867, 672744617, 3374451351, 37241362, 13667745, 2439425, 2844001732, 145114376}; //fill this out from python

             for (size_t i = 0; i < 1536; i++) {
                python_weights[i] = static_cast<int32_t>(python_weights[i]);
             }

             network.copy_init(python_weights);
         
         
         //input init
             uint32_t original[batch_size*input_dim/WORD_SIZE] = {2723899432, 1170451972, 824846163, 1506090442}; //fill this out from python

             std::cout<<"Initialising input activations batch to given list..."<<std::endl;
             uint32_t* input_batch = new uint32_t[batch_size*input_dim/WORD_SIZE];
             copy_array<uint32_t>(input_batch, batch_size*input_dim/WORD_SIZE, original, 0);
             print<uint32_t>(input_batch, batch_size,input_dim/WORD_SIZE);
             std::cout<<std::endl<<"Inputs initialised."<<std::endl<<std::endl<<std::endl<<"_____________________"<<std::endl;
      
    // #########################################################################################


    //forward pass
        // network.forward_pass(batch_size, input_batch);  


    //forward pass debug mode:
        network.forward_pass_debug(batch_size, input_batch, 1);
        
        network.forward_pass_debug(batch_size, input_batch, 0);

        network.forward_pass_debug(batch_size, input_batch, 1);

        network.forward_pass_debug(batch_size, input_batch, 0);




    //print final layer activations matrix
    std::cout<<"Output activations:"<<std::endl;
    print(network.A_list[depth+1], batch_size,network.layers[depth+1]);
    std::cout<<std::endl<<std::endl<<"_____________________"<<std::endl;





    //functions yet to be defined:
    
    // network.loss_calc(){
    //     loss = true_output - output_batch;
    // }

    // network.backprop(){
    //     ...
    // }

    return 0;
}
